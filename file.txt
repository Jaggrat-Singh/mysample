some changes from the jagrat ]]]] branch 
